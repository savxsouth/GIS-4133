/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var region = ee.FeatureCollection("users/onlynishan/study_region"),
    val_points = ee.FeatureCollection("users/onlynishan/validation_points"),
    Water = 
    /* color: #0537d6 */
    /* locked: true */
    /* displayProperties: [
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      }
    ] */
    ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.60427348628718, 35.575485484428974],
                  [-97.60427348628718, 35.57206470329552],
                  [-97.59732120052058, 35.57206470329552],
                  [-97.59732120052058, 35.575485484428974]]], null, false),
            {
              "LC": 1,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.59062640681941, 35.57115712459917],
                  [-97.59062640681941, 35.56801542664239],
                  [-97.58564822688777, 35.56801542664239],
                  [-97.58564822688777, 35.57115712459917]]], null, false),
            {
              "LC": 1,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.5994669677325, 35.56696816661399],
                  [-97.5994669677325, 35.56124290319054],
                  [-97.59354465022761, 35.56124290319054],
                  [-97.59354465022761, 35.56696816661399]]], null, false),
            {
              "LC": 1,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.68569329176383, 35.507031703690544],
                  [-97.68569329176383, 35.50423685593952],
                  [-97.68097260389762, 35.50423685593952],
                  [-97.68097260389762, 35.507031703690544]]], null, false),
            {
              "LC": 1,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.68148758802847, 35.500882910252294],
                  [-97.68148758802847, 35.49683003902303],
                  [-97.67633774671988, 35.49683003902303],
                  [-97.67633774671988, 35.500882910252294]]], null, false),
            {
              "LC": 1,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.67419197950797, 35.508778434142435],
                  [-97.67419197950797, 35.505494549463904],
                  [-97.67007210646109, 35.505494549463904],
                  [-97.67007210646109, 35.508778434142435]]], null, false),
            {
              "LC": 1,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.67453530226187, 35.49221790234672],
                  [-97.67453530226187, 35.489003226274434],
                  [-97.66972878370719, 35.489003226274434],
                  [-97.66972878370719, 35.49221790234672]]], null, false),
            {
              "LC": 1,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.68380501661734, 35.49102988486726],
                  [-97.68380501661734, 35.488583911218335],
                  [-97.68002846632437, 35.488583911218335],
                  [-97.68002846632437, 35.49102988486726]]], null, false),
            {
              "LC": 1,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.35738460152957, 35.33899501676629],
                  [-97.35738460152957, 35.33566919406929],
                  [-97.35541049569461, 35.33566919406929],
                  [-97.35541049569461, 35.33899501676629]]], null, false),
            {
              "LC": 1,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.35008899300907, 35.33885498488679],
                  [-97.35008899300907, 35.3371395746683],
                  [-97.34781447976444, 35.3371395746683],
                  [-97.34781447976444, 35.33885498488679]]], null, false),
            {
              "LC": 1,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.35717002480838, 35.34935670241836],
                  [-97.35717002480838, 35.34834159599307],
                  [-97.35515300362918, 35.34834159599307],
                  [-97.35515300362918, 35.34935670241836]]], null, false),
            {
              "LC": 1,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.35279265969608, 35.33311346889229],
                  [-97.35279265969608, 35.33080274368725],
                  [-97.34953109353397, 35.33080274368725],
                  [-97.34953109353397, 35.33311346889229]]], null, false),
            {
              "LC": 1,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.34764281838748, 35.34753650251618],
                  [-97.34764281838748, 35.34585628158676],
                  [-97.34549705117557, 35.34585628158676],
                  [-97.34549705117557, 35.34753650251618]]], null, false),
            {
              "LC": 1,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.25916156261755, 35.22422723045296],
                  [-97.25916156261755, 35.22226398159687],
                  [-97.25645789593054, 35.22226398159687],
                  [-97.25645789593054, 35.22422723045296]]], null, false),
            {
              "LC": 1,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.24499949901892, 35.225173779895385],
                  [-97.24499949901892, 35.22268468177864],
                  [-97.2422958323319, 35.22268468177864],
                  [-97.2422958323319, 35.225173779895385]]], null, false),
            {
              "LC": 1,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.29791245595263, 35.22180707354638],
                  [-97.29791245595263, 35.21966846852879],
                  [-97.2954233659868, 35.21966846852879],
                  [-97.2954233659868, 35.22180707354638]]], null, false),
            {
              "LC": 1,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.37395078222997, 35.64078584525894],
                  [-97.37395078222997, 35.63820492727486],
                  [-97.37068921606786, 35.63820492727486],
                  [-97.37068921606786, 35.64078584525894]]], null, false),
            {
              "LC": 1,
              "system:index": "16"
            })]),
    Forest = 
    /* color: #98ff00 */
    /* locked: true */
    /* displayProperties: [
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      }
    ] */
    ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.67348981843084, 35.534890049285416],
                  [-97.67348981843084, 35.53425270445553],
                  [-97.67265296921819, 35.53425270445553],
                  [-97.67265296921819, 35.534890049285416]]], null, false),
            {
              "LC": 2,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.67355114566021, 35.531634164091635],
                  [-97.67355114566021, 35.53107537361826],
                  [-97.67269283877545, 35.53107537361826],
                  [-97.67269283877545, 35.531634164091635]]], null, false),
            {
              "LC": 2,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.6809325848692, 35.538828243812695],
                  [-97.6809325848692, 35.53837426756277],
                  [-97.68011719332867, 35.53837426756277],
                  [-97.68011719332867, 35.538828243812695]]], null, false),
            {
              "LC": 2,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.6699462567442, 35.52698910000321],
                  [-97.6699462567442, 35.52643027718054],
                  [-97.66921669589215, 35.52643027718054],
                  [-97.66921669589215, 35.52698910000321]]], null, false),
            {
              "LC": 2,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.30982297219187, 35.296240732064774],
                  [-97.30982297219187, 35.295295012317894],
                  [-97.30849259652048, 35.295295012317894],
                  [-97.30849259652048, 35.296240732064774]]], null, false),
            {
              "LC": 2,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.30913632668405, 35.28818424701693],
                  [-97.30913632668405, 35.28755370565919],
                  [-97.30823510445505, 35.28755370565919],
                  [-97.30823510445505, 35.28818424701693]]], null, false),
            {
              "LC": 2,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.33501427925974, 35.28842945621868],
                  [-97.33501427925974, 35.28807915713167],
                  [-97.3340701416865, 35.28807915713167],
                  [-97.3340701416865, 35.28842945621868]]], null, false),
            {
              "LC": 2,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.33050816811472, 35.29900777452021],
                  [-97.33050816811472, 35.298482393988614],
                  [-97.32960694588571, 35.298482393988614],
                  [-97.32960694588571, 35.29900777452021]]], null, false),
            {
              "LC": 2,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.23136859043642, 35.27321696281259],
                  [-97.23136859043642, 35.27262134158267],
                  [-97.23072486027284, 35.27262134158267],
                  [-97.23072486027284, 35.27321696281259]]], null, false),
            {
              "LC": 2,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.24651770695253, 35.27107971335619],
                  [-97.24651770695253, 35.2704840764112],
                  [-97.24574523075624, 35.2704840764112],
                  [-97.24574523075624, 35.27107971335619]]], null, false),
            {
              "LC": 2,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.23441557987734, 35.26750582599418],
                  [-97.23441557987734, 35.2666648884084],
                  [-97.2334714423041, 35.2666648884084],
                  [-97.2334714423041, 35.26750582599418]]], null, false),
            {
              "LC": 2,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.22699122532411, 35.28176539672191],
                  [-97.22699122532411, 35.2809946732974],
                  [-97.22578959568544, 35.2809946732974],
                  [-97.22578959568544, 35.28176539672191]]], null, false),
            {
              "LC": 2,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.21787171467348, 35.26684008445855],
                  [-97.21787171467348, 35.266437132976826],
                  [-97.21729235752626, 35.266437132976826],
                  [-97.21729235752626, 35.26684008445855]]], null, false),
            {
              "LC": 2,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.80123776432633, 35.595493760034266],
                  [-97.80123776432633, 35.595005208050736],
                  [-97.80037945744157, 35.595005208050736],
                  [-97.80037945744157, 35.595493760034266]]], null, false),
            {
              "LC": 2,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.79250449177384, 35.59690705433907],
                  [-97.79250449177384, 35.59663661106333],
                  [-97.79219335552811, 35.59663661106333],
                  [-97.79219335552811, 35.59690705433907]]], null, false),
            {
              "LC": 2,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.7950901412642, 35.597160048834255],
                  [-97.7950901412642, 35.59688960641337],
                  [-97.79475754734635, 35.59688960641337],
                  [-97.79475754734635, 35.597160048834255]]], null, false),
            {
              "LC": 2,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.79050892826676, 35.595188415394006],
                  [-97.79050892826676, 35.594996483881076],
                  [-97.79022997852921, 35.594996483881076],
                  [-97.79022997852921, 35.595188415394006]]], null, false),
            {
              "LC": 2,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.45698242219116, 35.56298108813875],
                  [-97.45698242219116, 35.56256215945139],
                  [-97.45616703065063, 35.56256215945139],
                  [-97.45616703065063, 35.56298108813875]]], null, false),
            {
              "LC": 2,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.45975046189453, 35.567920790414114],
                  [-97.45975046189453, 35.567693884968186],
                  [-97.45942859681274, 35.567693884968186],
                  [-97.45942859681274, 35.567920790414114]]], null, false),
            {
              "LC": 2,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.48258491596184, 35.544833992756864],
                  [-97.48258491596184, 35.54453718464929],
                  [-97.48226305088005, 35.54453718464929],
                  [-97.48226305088005, 35.544833992756864]]], null, false),
            {
              "LC": 2,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.48103996356926, 35.54634420522989],
                  [-97.48103996356926, 35.54609105020996],
                  [-97.48070736965141, 35.54609105020996],
                  [-97.48070736965141, 35.54634420522989]]], null, false),
            {
              "LC": 2,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.49837682432553, 35.53428919954173],
                  [-97.49837682432553, 35.534062198893686],
                  [-97.49807641691586, 35.534062198893686],
                  [-97.49807641691586, 35.53428919954173]]], null, false),
            {
              "LC": 2,
              "system:index": "21"
            })]),
    Urban = 
    /* color: #f50000 */
    /* displayProperties: [
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      }
    ] */
    ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.54365422619149, 35.46346726537811],
                  [-97.54365422619149, 35.46315267938658],
                  [-97.54316069973275, 35.46315267938658],
                  [-97.54316069973275, 35.46346726537811]]], null, false),
            {
              "LC": 3,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.55584649034643, 35.452499672378714],
                  [-97.55584649034643, 35.45208016693079],
                  [-97.55551926084661, 35.45208016693079],
                  [-97.55551926084661, 35.452499672378714]]], null, false),
            {
              "LC": 3,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.55516520925664, 35.452652616529235],
                  [-97.55516520925664, 35.452582699239365],
                  [-97.55505792089605, 35.452582699239365],
                  [-97.55505792089605, 35.452652616529235]]], null, false),
            {
              "LC": 3,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.55641511865758, 35.450511371968055],
                  [-97.55641511865758, 35.450450192714804],
                  [-97.55634001680517, 35.450450192714804],
                  [-97.55634001680517, 35.450511371968055]]], null, false),
            {
              "LC": 3,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.56877472765719, 35.45291777285643],
                  [-97.56877472765719, 35.452893738874096],
                  [-97.56873047120844, 35.452893738874096],
                  [-97.56873047120844, 35.45291777285643]]], null, false),
            {
              "LC": 3,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.56901612646853, 35.452824914248566],
                  [-97.56901612646853, 35.45280525005903],
                  [-97.56898796327387, 35.45280525005903],
                  [-97.56898796327387, 35.452824914248566]]], null, false),
            {
              "LC": 3,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.51541679523291, 35.47062871097406],
                  [-97.51541679523291, 35.470427743517675],
                  [-97.51522367618384, 35.470427743517675],
                  [-97.51522367618384, 35.47062871097406]]], null, false),
            {
              "LC": 3,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.51530414245428, 35.47133646193014],
                  [-97.51530414245428, 35.471266560878405],
                  [-97.51522367618384, 35.471266560878405],
                  [-97.51522367618384, 35.47133646193014]]], null, false),
            {
              "LC": 3,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.51417552637696, 35.46752038491213],
                  [-97.51417552637696, 35.46739805222667],
                  [-97.51399850058198, 35.46739805222667],
                  [-97.51399850058198, 35.46752038491213]]], null, false),
            {
              "LC": 3,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.51405214476227, 35.46825874609835],
                  [-97.51405214476227, 35.46805777271913],
                  [-97.51381611036896, 35.46805777271913],
                  [-97.51381611036896, 35.46825874609835]]], null, false),
            {
              "LC": 3,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.51128705558732, 35.47100044495995],
                  [-97.51128705558732, 35.470915252689025],
                  [-97.51105906782105, 35.470915252689025],
                  [-97.51105906782105, 35.47100044495995]]], null, false),
            {
              "LC": 3,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.50870140609696, 35.46883784399483],
                  [-97.50870140609696, 35.46878104763018],
                  [-97.50860752878144, 35.46878104763018],
                  [-97.50860752878144, 35.46883784399483]]], null, false),
            {
              "LC": 3,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.51100234528496, 35.46797153537391],
                  [-97.51100234528496, 35.467875417390196],
                  [-97.51088969250634, 35.467875417390196],
                  [-97.51088969250634, 35.46797153537391]]], null, false),
            {
              "LC": 3,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.51199476262047, 35.46716326693216],
                  [-97.51199476262047, 35.46689238596131],
                  [-97.51173190613702, 35.46689238596131],
                  [-97.51173190613702, 35.46716326693216]]], null, false),
            {
              "LC": 3,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.52196190958144, 35.464677403398],
                  [-97.52196190958144, 35.464441467569486],
                  [-97.5214683831227, 35.464441467569486],
                  [-97.5214683831227, 35.464677403398]]], null, false),
            {
              "LC": 3,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.45820456169298, 35.23061680887],
                  [-97.45820456169298, 35.23058394495965],
                  [-97.45816164634874, 35.23058394495965],
                  [-97.45816164634874, 35.23061680887]]], null, false),
            {
              "LC": 3,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.45672934673479, 35.23018081324277],
                  [-97.45672934673479, 35.23013480351729],
                  [-97.45666095040491, 35.23013480351729],
                  [-97.45666095040491, 35.23018081324277]]], null, false),
            {
              "LC": 3,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.45664753935984, 35.230020874560935],
                  [-97.45664753935984, 35.229980342105215],
                  [-97.45659523628404, 35.229980342105215],
                  [-97.45659523628404, 35.230020874560935]]], null, false),
            {
              "LC": 3,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.45434230859392, 35.232409005468625],
                  [-97.45434230859392, 35.23207818213856],
                  [-97.45392656619661, 35.23207818213856],
                  [-97.45392656619661, 35.232409005468625]]], null, false),
            {
              "LC": 3,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.49013313175494, 35.25147831408554],
                  [-97.49013313175494, 35.25138850913644],
                  [-97.48999365688617, 35.25138850913644],
                  [-97.48999365688617, 35.25147831408554]]], null, false),
            {
              "LC": 3,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.60350628421527, 35.26561536466157],
                  [-97.60350628421527, 35.26550148555069],
                  [-97.60338826701862, 35.26550148555069],
                  [-97.60338826701862, 35.26561536466157]]], null, false),
            {
              "LC": 3,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.59876773683168, 35.2630129105028],
                  [-97.59876773683168, 35.2627063026847],
                  [-97.59832785455323, 35.2627063026847],
                  [-97.59832785455323, 35.2630129105028]]], null, false),
            {
              "LC": 3,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.59829566804505, 35.26167258777759],
                  [-97.59829566804505, 35.26160250493371],
                  [-97.5982312950287, 35.26160250493371],
                  [-97.5982312950287, 35.26167258777759]]], null, false),
            {
              "LC": 3,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.564385587422, 35.39074501760458],
                  [-97.564385587422, 35.39063787442393],
                  [-97.5643319432417, 35.39063787442393],
                  [-97.5643319432417, 35.39074501760458]]], null, false),
            {
              "LC": 3,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.56207087412433, 35.38954893993992],
                  [-97.56207087412433, 35.38949646088688],
                  [-97.56201454773502, 35.38949646088688],
                  [-97.56201454773502, 35.38954893993992]]], null, false),
            {
              "LC": 3,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.56127264518116, 35.3913543541314],
                  [-97.56127264518116, 35.391290943357504],
                  [-97.5610983015952, 35.391290943357504],
                  [-97.5610983015952, 35.3913543541314]]], null, false),
            {
              "LC": 3,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.46597007095555, 35.52812326741561],
                  [-97.46597007095555, 35.528044684301996],
                  [-97.46571257889012, 35.528044684301996],
                  [-97.46571257889012, 35.52812326741561]]], null, false),
            {
              "LC": 3,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.47576966790658, 35.541254008442564],
                  [-97.47576966790658, 35.54100738489217],
                  [-97.47541025189858, 35.54100738489217],
                  [-97.47541025189858, 35.541254008442564]]], null, false),
            {
              "LC": 3,
              "system:index": "27"
            })]),
    Other = 
    /* color: #ffc82d */
    /* locked: true */
    /* displayProperties: [
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      }
    ] */
    ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.33139249361675, 35.54186341595866],
                  [-97.33139249361675, 35.54093803513289],
                  [-97.32980462587993, 35.54093803513289],
                  [-97.32980462587993, 35.54186341595866]]], null, false),
            {
              "LC": 4,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.33388158358257, 35.535245835244886],
                  [-97.33388158358257, 35.53465214696499],
                  [-97.33321639574687, 35.53465214696499],
                  [-97.33321639574687, 35.535245835244886]]], null, false),
            {
              "LC": 4,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.61508529964685, 35.76067171071944],
                  [-97.61508529964685, 35.75920907641664],
                  [-97.61302536312341, 35.75920907641664],
                  [-97.61302536312341, 35.76067171071944]]], null, false),
            {
              "LC": 4,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.63036316219568, 35.765546964191294],
                  [-97.63036316219568, 35.76429335612092],
                  [-97.628260310328, 35.76429335612092],
                  [-97.628260310328, 35.765546964191294]]], null, false),
            {
              "LC": 4,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.75381511173468, 35.7705083254331],
                  [-97.75381511173468, 35.76995120348321],
                  [-97.75278514347296, 35.76995120348321],
                  [-97.75278514347296, 35.7705083254331]]], null, false),
            {
              "LC": 4,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.74239455454337, 35.764897203743956],
                  [-97.74239455454337, 35.76411369461515],
                  [-97.74132167093741, 35.76411369461515],
                  [-97.74132167093741, 35.764897203743956]]], null, false),
            {
              "LC": 4,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.85787319651345, 35.7901910641252],
                  [-97.85787319651345, 35.78834603955886],
                  [-97.85426830759744, 35.78834603955886],
                  [-97.85426830759744, 35.7901910641252]]], null, false),
            {
              "LC": 4,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.77635235140401, 35.4692529756483],
                  [-97.77635235140401, 35.468379185494925],
                  [-97.7752150947817, 35.468379185494925],
                  [-97.7752150947817, 35.4692529756483]]], null, false),
            {
              "LC": 4,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.78391238085018, 35.414570537212875],
                  [-97.78391238085018, 35.41415083411808],
                  [-97.78266783586727, 35.41415083411808],
                  [-97.78266783586727, 35.414570537212875]]], null, false),
            {
              "LC": 4,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.77223940721737, 35.41481536300866],
                  [-97.77223940721737, 35.41397595718341],
                  [-97.77026530138241, 35.41397595718341],
                  [-97.77026530138241, 35.41481536300866]]], null, false),
            {
              "LC": 4,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.84347761856304, 35.37263285028459],
                  [-97.84347761856304, 35.37102313965845],
                  [-97.84124602066265, 35.37102313965845],
                  [-97.84124602066265, 35.37263285028459]]], null, false),
            {
              "LC": 4,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.8560947297691, 35.380121081942754],
                  [-97.8560947297691, 35.37774171916867],
                  [-97.85085905777203, 35.37774171916867],
                  [-97.85085905777203, 35.380121081942754]]], null, false),
            {
              "LC": 4,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.9394063230284, 35.56483175105844],
                  [-97.9394063230284, 35.563875527755734],
                  [-97.93802012191998, 35.563875527755734],
                  [-97.93802012191998, 35.56483175105844]]], null, false),
            {
              "LC": 4,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.89921265510387, 35.527335924074976],
                  [-97.89921265510387, 35.52590393899013],
                  [-97.8973458376295, 35.52590393899013],
                  [-97.8973458376295, 35.527335924074976]]], null, false),
            {
              "LC": 4,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.88935793219672, 35.46779081778933],
                  [-97.88935793219672, 35.46639272356763],
                  [-97.8866542655097, 35.46639272356763],
                  [-97.8866542655097, 35.46779081778933]]], null, false),
            {
              "LC": 4,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.3862456778151, 35.25387409612173],
                  [-97.3862456778151, 35.25264751958918],
                  [-97.38414282594742, 35.25264751958918],
                  [-97.38414282594742, 35.25387409612173]]], null, false),
            {
              "LC": 4,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.36053938661637, 35.25015926446845],
                  [-97.36053938661637, 35.24973870676233],
                  [-97.35989565645279, 35.24973870676233],
                  [-97.35989565645279, 35.25015926446845]]], null, false),
            {
              "LC": 4,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.40055026763217, 35.36448341583092],
                  [-97.40055026763217, 35.363800973522956],
                  [-97.39952029937045, 35.363800973522956],
                  [-97.39952029937045, 35.36448341583092]]], null, false),
            {
              "LC": 4,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.46365214062696, 35.741708306604785],
                  [-97.46365214062696, 35.740593655442396],
                  [-97.46197844220167, 35.740593655442396],
                  [-97.46197844220167, 35.741708306604785]]], null, false),
            {
              "LC": 4,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.48807097149854, 35.74240495565643],
                  [-97.48807097149854, 35.74195213446627],
                  [-97.48742724133497, 35.74195213446627],
                  [-97.48742724133497, 35.74240495565643]]], null, false),
            {
              "LC": 4,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.4934319165532, 35.73074672260072],
                  [-97.4934319165532, 35.72865645115468],
                  [-97.48991285832567, 35.72865645115468],
                  [-97.48991285832567, 35.73074672260072]]], null, false),
            {
              "LC": 4,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-97.52579008610887, 35.70123397919908],
                  [-97.52579008610887, 35.700293015418474],
                  [-97.52450262578172, 35.700293015418474],
                  [-97.52450262578172, 35.70123397919908]]], null, false),
            {
              "LC": 4,
              "system:index": "21"
            })]);
/***** End of imports. If edited, may not auto-convert in the playground. *****/

// Lab 10 section 4

///////////////////////////////////////////////////////////////////////////////////// 4.2

// Write a Function to mask clouds based on the QA_PIXEL band of Landsat 8 SR data.
function maskL8sr(image) {
  // Bits 3 and 4 are cloud and cloud shadow, respectively. SEE BANDS for reference
  var cloudsBitMask = (1 << 3); //pushes "1" 3 spaces to the left 
  var cloudShadowBitMask = (1 << 4);// pushes "1" 4 spaces to the left
  
  // Get the pixel QA band from the Landsat 8 collection level 2 SR image
  var qa = image.select('QA_PIXEL');
  // Set both flags to zero to indicate clear sky conditions.
  var mask = qa.bitwiseAnd(cloudShadowBitMask).eq(0)
                 .and(qa.bitwiseAnd(cloudsBitMask).eq(0));
  return image.updateMask(mask);
}

// Create a cloud-free Landsat 8 collection 2 level 1 collection covering the specific 
// region within a specific period
var l8collection = ee.ImageCollection('LANDSAT/LC08/C02/T1_L2')
    .filterDate('2020-01-01', '2020-12-31')
    .filterBounds(region)
    .map(maskL8sr);

// subset spectral bands
var l8optical = l8collection.select('SR_B[1-7]');

// Create a median composite from all cloud-free Landsat 8 pixels
var l8_input = l8optical.median();

// clip Landsat 8 composite to study region only
var l8_input = l8_input.clip(region);
print(l8_input)

// Define true-color visualization parameters for SR image.
var tc_sr = {
  bands: ['SR_B4', 'SR_B3', 'SR_B2'],
  min: 1000,
  max: 30000
};

// Display the true color composite Landsat 8 image
Map.centerObject(region,9);
Map.addLayer(l8_input, tc_sr, 'median Landsat 8 composite - True color');

// False color composite visualization parameters
var fcc_sr = {
  bands: ['SR_B5', 'SR_B4', 'SR_B3'],
  min: 1000,
  max: 30000
};

// Display the False color composite Landsat 8 image
Map.centerObject(region,9);
Map.addLayer(l8_input, fcc_sr, 'median Landsat 8 composite - FCC');

///////////////////////////////////////////////////////////////////////////////////// 4.4

// merge training polygons
var sample_polygon = Water.merge(Forest) //Merges all points
                          .merge(Urban)
                          .merge(Other);

///////////////////////////////////////////////////////////////////////////////////// 4.5

// generate training pixels from the training polygons
// the pixel values will have band values from the Landsat 8 image
var sample_pixels = l8_input.sampleRegions({
  collection: sample_polygon,
  properties: ['LC'],
  scale: 30
});

///////////////////////////////////////////////////////////////////////////////////// 4.6

// Add a random value field to the sample and use it to approximately split 70%
// of the features into a training set and 30% into a validation set.
sample_pixels = sample_pixels.randomColumn();
var trainingSample = sample_pixels.filter('random <= 0.7');
var validationSample = sample_pixels.filter('random > 0.7');

///////////////////////////////////////////////////////////////////////////////////// 4.7

// Train a 10-tree random forest classifier from the training sample.
var trainedClassifier = ee.Classifier.smileRandomForest(10).train({
  features: trainingSample,
  classProperty: 'LC',
  inputProperties: l8_input.bandNames()
});

// Get information about the trained classifier.
print('Results of trained classifier', trainedClassifier.explain());

///////////////////////////////////////////////////////////////////////////////////// 4.8

// Get a confusion matrix and overall accuracy for the training sample.
var trainAccuracy = trainedClassifier.confusionMatrix();
print('Training overall accuracy', trainAccuracy.accuracy().multiply(100));

///////////////////////////////////////////////////////////////////////////////////// 4.9

// Get a confusion matrix and overall accuracy for the validation sample.
validationSample = validationSample.classify(trainedClassifier);
var validationAccuracy = validationSample.errorMatrix("LC", 'classification');
print('Validation accuracy', validationAccuracy.accuracy().multiply(100));

///////////////////////////////////////////////////////////////////////////////////// 4.10

// Classify the L8 image from the trained classifier.
var new_lc = l8_input.classify(trainedClassifier);

///////////////////////////////////////////////////////////////////////////////////// 4.11

// Get reference dataset for accuracy assignment- extract pixel values from new land cover data
var validation = new_lc.sampleRegions({
  collection: val_points,
  scale: 30,
});
print(validation);

//Compare the landcover of your validation data against the classification cluster
var confusionMatrix = validation.errorMatrix('ref_lc', 'classification');
//Print the error matrix to the console
print('Validation error matrix: ', confusionMatrix);

// Calculate overall accuracy to the console.
print("Overall accuracy (%)", confusionMatrix.accuracy().multiply(100));

// Calculate kappa coefficient to the console
print('Kappa coefficient (%)', confusionMatrix.kappa().multiply(100));

///////////////////////////////////////////////////////////////////////////////////// 
