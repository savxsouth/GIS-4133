/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var region = ee.FeatureCollection("users/onlynishan/newstudy_region"),
    val_points = ee.FeatureCollection("users/onlynishan/newstudy_val"),
    Water = 
    /* color: #1974f1 */
    /* locked: true */
    /* displayProperties: [
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      }
    ] */
    ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-96.27131674925633, 36.170668043075736],
                  [-96.27131674925633, 36.16512481494187],
                  [-96.26419280211277, 36.16512481494187],
                  [-96.26419280211277, 36.170668043075736]]], null, false),
            {
              "LC": 1,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-96.26711104552098, 36.155007413023384],
                  [-96.26711104552098, 36.1494630774545],
                  [-96.26067374388523, 36.1494630774545],
                  [-96.26067374388523, 36.155007413023384]]], null, false),
            {
              "LC": 1,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-96.2502023998911, 36.20004060618906],
                  [-96.2502023998911, 36.19740860886289],
                  [-96.24642584959813, 36.19740860886289],
                  [-96.24642584959813, 36.20004060618906]]], null, false),
            {
              "LC": 1,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-96.18449900786229, 36.19477652305226],
                  [-96.18449900786229, 36.19238678956505],
                  [-96.18102286497898, 36.19238678956505],
                  [-96.18102286497898, 36.19477652305226]]], null, false),
            {
              "LC": 1,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-96.32865164915867, 36.189373543391106],
                  [-96.32865164915867, 36.187156828510844],
                  [-96.32470343748875, 36.187156828510844],
                  [-96.32470343748875, 36.189373543391106]]], null, false),
            {
              "LC": 1,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.987775069874, 36.10414077319124],
                  [-95.987775069874, 36.1034646402194],
                  [-95.98704550902195, 36.1034646402194],
                  [-95.98704550902195, 36.10414077319124]]], null, false),
            {
              "LC": 1,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.84705726823073, 35.93385780315907],
                  [-95.84705726823073, 35.93291959242812],
                  [-95.84581272324782, 35.93291959242812],
                  [-95.84581272324782, 35.93385780315907]]], null, false),
            {
              "LC": 1,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.62022641839192, 36.54489760264131],
                  [-95.62022641839192, 36.52089734357293],
                  [-95.60340360345052, 36.52089734357293],
                  [-95.60340360345052, 36.54489760264131]]], null, false),
            {
              "LC": 1,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.64975217522786, 36.45492727379605],
                  [-95.64975217522786, 36.45023270215551],
                  [-95.64357236565755, 36.45023270215551],
                  [-95.64357236565755, 36.45492727379605]]], null, false),
            {
              "LC": 1,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-96.11450572948311, 36.3450444187731],
                  [-96.11450572948311, 36.34186421696784],
                  [-96.10987087230538, 36.34186421696784],
                  [-96.10987087230538, 36.3450444187731]]], null, false),
            {
              "LC": 1,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-96.15999599437569, 36.37144890287406],
                  [-96.15999599437569, 36.369513799901576],
                  [-96.15604778270577, 36.369513799901576],
                  [-96.15604778270577, 36.37144890287406]]], null, false),
            {
              "LC": 1,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-96.17287059764718, 36.365643449561226],
                  [-96.17287059764718, 36.36398466905149],
                  [-96.17063899974679, 36.36398466905149],
                  [-96.17063899974679, 36.365643449561226]]], null, false),
            {
              "LC": 1,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-96.24805828075264, 36.381814706301476],
                  [-96.24805828075264, 36.37946524526893],
                  [-96.24428173045968, 36.37946524526893],
                  [-96.24428173045968, 36.381814706301476]]], null, false),
            {
              "LC": 1,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.26556955086203, 35.88614634866071],
                  [-95.26556955086203, 35.87376751077932],
                  [-95.25080667244406, 35.87376751077932],
                  [-95.25080667244406, 35.88614634866071]]], null, false),
            {
              "LC": 1,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.29509530769796, 35.969270826512236],
                  [-95.29509530769796, 35.9656585361496],
                  [-95.28685556160421, 35.9656585361496],
                  [-95.28685556160421, 35.969270826512236]]], null, false),
            {
              "LC": 1,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.43783174263449, 35.89410811793234],
                  [-95.43783174263449, 35.8938299910167],
                  [-95.43735967384787, 35.8938299910167],
                  [-95.43735967384787, 35.89410811793234]]], null, false),
            {
              "LC": 1,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.44336782204122, 35.89275223998982],
                  [-95.44336782204122, 35.89240457523855],
                  [-95.44287429558248, 35.89240457523855],
                  [-95.44287429558248, 35.89275223998982]]], null, false),
            {
              "LC": 1,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.60725907088685, 36.136002765464966],
                  [-95.60725907088685, 36.135586853140076],
                  [-95.60659388305116, 36.135586853140076],
                  [-95.60659388305116, 36.136002765464966]]], null, false),
            {
              "LC": 1,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.24571331738306, 36.213705417828685],
                  [-95.24571331738306, 36.21309947945775],
                  [-95.24521979092432, 36.21309947945775],
                  [-95.24521979092432, 36.213705417828685]]], null, false),
            {
              "LC": 1,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.57177268675372, 36.63487260655352],
                  [-95.57177268675372, 36.60593958575254],
                  [-95.55735313108966, 36.60593958575254],
                  [-95.55735313108966, 36.63487260655352]]], null, false),
            {
              "LC": 1,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-96.18294715500939, 36.522718792629874],
                  [-96.18294715500939, 36.52027012936358],
                  [-96.17693900681603, 36.52027012936358],
                  [-96.17693900681603, 36.522718792629874]]], null, false),
            {
              "LC": 1,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-96.20214708415935, 36.52980781726118],
                  [-96.20214708415935, 36.52963539452435],
                  [-96.2018681344218, 36.52963539452435],
                  [-96.2018681344218, 36.52980781726118]]], null, false),
            {
              "LC": 1,
              "system:index": "21"
            })]),
    Forest = 
    /* color: #98ff00 */
    /* locked: true */
    /* displayProperties: [
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      }
    ] */
    ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-96.16555736308761, 36.173905357614835],
                  [-96.16555736308761, 36.17363687762856],
                  [-96.16517112498947, 36.17363687762856],
                  [-96.16517112498947, 36.173905357614835]]], null, false),
            {
              "LC": 2,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-96.17295930220142, 36.17573285872932],
                  [-96.17295930220142, 36.1752478732663],
                  [-96.17235848738208, 36.1752478732663],
                  [-96.17235848738208, 36.17573285872932]]], null, false),
            {
              "LC": 2,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-96.15467736555591, 36.16710659776864],
                  [-96.15467736555591, 36.166760141753],
                  [-96.15416238142505, 36.166760141753],
                  [-96.15416238142505, 36.16710659776864]]], null, false),
            {
              "LC": 2,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-96.24088890127668, 36.174676575816655],
                  [-96.24088890127668, 36.174364795589234],
                  [-96.24052412085065, 36.174364795589234],
                  [-96.24052412085065, 36.174676575816655]]], null, false),
            {
              "LC": 2,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-96.08845744557661, 36.11481134773148],
                  [-96.08845744557661, 36.112354170397396],
                  [-96.08480159468931, 36.112354170397396],
                  [-96.08480159468931, 36.11481134773148]]], null, false),
            {
              "LC": 2,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.96812668763303, 36.310529136431434],
                  [-95.96812668763303, 36.31016602437396],
                  [-95.96763316117429, 36.31016602437396],
                  [-95.96763316117429, 36.310529136431434]]], null, false),
            {
              "LC": 2,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.9763342472186, 36.30911126071198],
                  [-95.9763342472186, 36.30891241022635],
                  [-95.97606602631711, 36.30891241022635],
                  [-95.97606602631711, 36.30911126071198]]], null, false),
            {
              "LC": 2,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.87305093169935, 36.29262362741329],
                  [-95.87305093169935, 36.29213936646686],
                  [-95.8725359475685, 36.29213936646686],
                  [-95.8725359475685, 36.29262362741329]]], null, false),
            {
              "LC": 2,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.86208316702617, 36.3059997387436],
                  [-95.86208316702617, 36.30565389768641],
                  [-95.86165401358379, 36.30565389768641],
                  [-95.86165401358379, 36.3059997387436]]], null, false),
            {
              "LC": 2,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.87202879805339, 36.305221594208035],
                  [-95.87202879805339, 36.30501408768719],
                  [-95.87171766180766, 36.30501408768719],
                  [-95.87171766180766, 36.305221594208035]]], null, false),
            {
              "LC": 2,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.73775415382119, 36.28677180296346],
                  [-95.73775415382119, 36.28588968783885],
                  [-95.73655252418251, 36.28588968783885],
                  [-95.73655252418251, 36.28677180296346]]], null, false),
            {
              "LC": 2,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.7475173946354, 36.28609724523582],
                  [-95.7475173946354, 36.28545727482214],
                  [-95.74663763007851, 36.28545727482214],
                  [-95.74663763007851, 36.28609724523582]]], null, false),
            {
              "LC": 2,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.75085856944675, 36.28093887089607],
                  [-95.75085856944675, 36.2805669722556],
                  [-95.7504186871683, 36.2805669722556],
                  [-95.7504186871683, 36.28093887089607]]], null, false),
            {
              "LC": 2,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.71477749377841, 36.3357615460471],
                  [-95.71477749377841, 36.33505284090416],
                  [-95.71394064456577, 36.33505284090416],
                  [-95.71394064456577, 36.3357615460471]]], null, false),
            {
              "LC": 2,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.7191334012186, 36.3329094007457],
                  [-95.7191334012186, 36.33266739573234],
                  [-95.71874716312045, 36.33266739573234],
                  [-95.71874716312045, 36.3329094007457]]], null, false),
            {
              "LC": 2,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.66743234745063, 36.33143034175853],
                  [-95.66743234745063, 36.33087717583599],
                  [-95.66668132892646, 36.33087717583599],
                  [-95.66668132892646, 36.33143034175853]]], null, false),
            {
              "LC": 2,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.64322517315796, 36.3159415662939],
                  [-95.64322517315796, 36.31569950858216],
                  [-95.6427638332074, 36.31569950858216],
                  [-95.6427638332074, 36.3159415662939]]], null, false),
            {
              "LC": 2,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.7807396896452, 35.879719052969605],
                  [-95.7807396896452, 35.879267014105665],
                  [-95.78013887482587, 35.879267014105665],
                  [-95.78013887482587, 35.879719052969605]]], null, false),
            {
              "LC": 2,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.76413145142499, 35.87815429206564],
                  [-95.76413145142499, 35.87766747125802],
                  [-95.76357355194989, 35.87766747125802],
                  [-95.76357355194989, 35.87815429206564]]], null, false),
            {
              "LC": 2,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.76035490113202, 35.87311207444665],
                  [-95.76035490113202, 35.872729548289726],
                  [-95.75971117096844, 35.872729548289726],
                  [-95.75971117096844, 35.87311207444665]]], null, false),
            {
              "LC": 2,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.67498555260602, 35.8948260986041],
                  [-95.67498555260602, 35.893748361137575],
                  [-95.67366590577069, 35.893748361137575],
                  [-95.67366590577069, 35.8948260986041]]], null, false),
            {
              "LC": 2,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.66792597847882, 35.89597335139805],
                  [-95.66792597847882, 35.89512160470133],
                  [-95.6664453991026, 35.89512160470133],
                  [-95.6664453991026, 35.89597335139805]]], null, false),
            {
              "LC": 2,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-96.22461648383315, 35.78755277831425],
                  [-96.22461648383315, 35.787213355365296],
                  [-96.22413368621046, 35.787213355365296],
                  [-96.22413368621046, 35.78755277831425]]], null, false),
            {
              "LC": 2,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-96.22993798651869, 35.78704799494197],
                  [-96.22993798651869, 35.78676949239873],
                  [-96.22965903678114, 35.78676949239873],
                  [-96.22965903678114, 35.78704799494197]]], null, false),
            {
              "LC": 2,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-96.23498053946669, 35.7895588253734],
                  [-96.23498053946669, 35.789423930087565],
                  [-96.23479814925368, 35.789423930087565],
                  [-96.23479814925368, 35.7895588253734]]], null, false),
            {
              "LC": 2,
              "system:index": "24"
            })]),
    Urban = 
    /* color: #ff1414 */
    /* locked: true */
    /* displayProperties: [
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      }
    ] */
    ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.94073952832396, 36.13982324044938],
                  [-95.94073952832396, 36.13978749981085],
                  [-95.94067783751662, 36.13978749981085],
                  [-95.94067783751662, 36.13982324044938]]], null, false),
            {
              "LC": 3,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.94180034198935, 36.13999977730391],
                  [-95.94180034198935, 36.139973784172355],
                  [-95.94176413216765, 36.139973784172355],
                  [-95.94176413216765, 36.13999977730391]]], null, false),
            {
              "LC": 3,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.93325669199909, 36.13968607657302],
                  [-95.93325669199909, 36.13933949939171],
                  [-95.93277925879444, 36.13933949939171],
                  [-95.93277925879444, 36.13968607657302]]], null, false),
            {
              "LC": 3,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.98825807005848, 36.14517695450344],
                  [-95.98825807005848, 36.14513363547158],
                  [-95.98820442587818, 36.14513363547158],
                  [-95.98820442587818, 36.14517695450344]]], null, false),
            {
              "LC": 3,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.99672172441785, 36.14913373991717],
                  [-95.99672172441785, 36.14902544775572],
                  [-95.99653933420484, 36.14902544775572],
                  [-95.99653933420484, 36.14913373991717]]], null, false),
            {
              "LC": 3,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.99680935068318, 36.153285010830196],
                  [-95.99680935068318, 36.152301764566424],
                  [-95.99565600080678, 36.152301764566424],
                  [-95.99565600080678, 36.153285010830196]]], null, false),
            {
              "LC": 3,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.9944007269878, 36.15312907832457],
                  [-95.9944007269878, 36.153077100753784],
                  [-95.99430416746327, 36.153077100753784],
                  [-95.99430416746327, 36.15312907832457]]], null, false),
            {
              "LC": 3,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.99208057959751, 36.15535056306459],
                  [-95.99208057959751, 36.15452110705033],
                  [-95.99124104817585, 36.15452110705033],
                  [-95.99124104817585, 36.15535056306459]]], null, false),
            {
              "LC": 3,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.99084944565968, 36.1539840133585],
                  [-95.99084944565968, 36.15395802486076],
                  [-95.99080921252445, 36.15395802486076],
                  [-95.99080921252445, 36.1539840133585]]], null, false),
            {
              "LC": 3,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.99106750269637, 36.155806988293726],
                  [-95.99106750269637, 36.15526990340942],
                  [-95.99046668787703, 36.15526990340942],
                  [-95.99046668787703, 36.155806988293726]]], null, false),
            {
              "LC": 3,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.87271410091809, 36.19254587808685],
                  [-95.87271410091809, 36.19219953455308],
                  [-95.87219911678723, 36.19219953455308],
                  [-95.87219911678723, 36.19254587808685]]], null, false),
            {
              "LC": 3,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.9501725437365, 36.20480754080598],
                  [-95.9501725437365, 36.204755597509624],
                  [-95.95010817072014, 36.204755597509624],
                  [-95.95010817072014, 36.20480754080598]]], null, false),
            {
              "LC": 3,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.94852030298333, 36.20382926960271],
                  [-95.94852030298333, 36.203742696340974],
                  [-95.94837009927849, 36.203742696340974],
                  [-95.94837009927849, 36.20382926960271]]], null, false),
            {
              "LC": 3,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.85655956128933, 36.17112710266527],
                  [-95.85655956128933, 36.17097986659903],
                  [-95.85615186551907, 36.17097986659903],
                  [-95.85615186551907, 36.17112710266527]]], null, false),
            {
              "LC": 3,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.86187033513882, 36.17182863541706],
                  [-95.86187033513882, 36.17170738329159],
                  [-95.86173086027004, 36.17170738329159],
                  [-95.86173086027004, 36.17182863541706]]], null, false),
            {
              "LC": 3,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.86733131269314, 36.17193256566099],
                  [-95.86733131269314, 36.17190658311294],
                  [-95.86726693967678, 36.17190658311294],
                  [-95.86726693967678, 36.17193256566099]]], null, false),
            {
              "LC": 3,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.87244360307552, 36.15959421668326],
                  [-95.87244360307552, 36.1594642834055],
                  [-95.8722773061166, 36.1594642834055],
                  [-95.8722773061166, 36.15959421668326]]], null, false),
            {
              "LC": 3,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.88111138422556, 36.15632935862518],
                  [-95.88111138422556, 36.15611279402493],
                  [-95.88083243448801, 36.15611279402493],
                  [-95.88083243448801, 36.15632935862518]]], null, false),
            {
              "LC": 3,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.88279581148691, 36.15577495205418],
                  [-95.88279581148691, 36.15567100038574],
                  [-95.8826670654542, 36.15567100038574],
                  [-95.8826670654542, 36.15577495205418]]], null, false),
            {
              "LC": 3,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.87545594651766, 36.15555297176178],
                  [-95.87545594651766, 36.155523735286174],
                  [-95.87541169006892, 36.155523735286174],
                  [-95.87541169006892, 36.15555297176178]]], null, false),
            {
              "LC": 3,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.87586498339243, 36.15594170756784],
                  [-95.87586498339243, 36.15591030558263],
                  [-95.8758234091527, 36.15591030558263],
                  [-95.8758234091527, 36.15594170756784]]], null, false),
            {
              "LC": 3,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.87709614651742, 36.148873805697484],
                  [-95.87709614651742, 36.14878717169319],
                  [-95.87695667164864, 36.14878717169319],
                  [-95.87695667164864, 36.148873805697484]]], null, false),
            {
              "LC": 3,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.87475726025643, 36.14837132714042],
                  [-95.87475726025643, 36.14834533678266],
                  [-95.87469288724007, 36.14834533678266],
                  [-95.87469288724007, 36.14837132714042]]], null, false),
            {
              "LC": 3,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.9082472371967, 36.141295023175175],
                  [-95.9082472371967, 36.14116505957689],
                  [-95.90807557581975, 36.14116505957689],
                  [-95.90807557581975, 36.141295023175175]]], null, false),
            {
              "LC": 3,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.91423392771794, 36.142386708900865],
                  [-95.91423392771794, 36.14225674711108],
                  [-95.91407299517705, 36.14225674711108],
                  [-95.91407299517705, 36.142386708900865]]], null, false),
            {
              "LC": 3,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.89120260443688, 36.0991057822724],
                  [-95.89120260443688, 36.098897728645134],
                  [-95.89096657004357, 36.098897728645134],
                  [-95.89096657004357, 36.0991057822724]]], null, false),
            {
              "LC": 3,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.88442198004724, 36.098923735378676],
                  [-95.88442198004724, 36.098828377313616],
                  [-95.88429323401452, 36.098828377313616],
                  [-95.88429323401452, 36.098923735378676]]], null, false),
            {
              "LC": 3,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.90630880560876, 36.091866925999355],
                  [-95.90630880560876, 36.09172821086526],
                  [-95.90611568655969, 36.09172821086526],
                  [-95.90611568655969, 36.091866925999355]]], null, false),
            {
              "LC": 3,
              "system:index": "27"
            })]),
    Other = 
    /* color: #ffc82d */
    /* locked: true */
    /* displayProperties: [
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      }
    ] */
    ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.62217710626359, 36.09996621368204],
                  [-95.62217710626359, 36.09918601828288],
                  [-95.62119005334611, 36.09918601828288],
                  [-95.62119005334611, 36.09996621368204]]], null, false),
            {
              "LC": 4,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.62447307718034, 36.09133161975481],
                  [-95.62447307718034, 36.09091547078382],
                  [-95.62395809304948, 36.09091547078382],
                  [-95.62395809304948, 36.09133161975481]]], null, false),
            {
              "LC": 4,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.63188014219979, 36.13491799317089],
                  [-95.63188014219979, 36.1345194050602],
                  [-95.63142953108529, 36.1345194050602],
                  [-95.63142953108529, 36.13491799317089]]], null, false),
            {
              "LC": 4,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.64149317930917, 36.13025611864012],
                  [-95.64149317930917, 36.1298748378408],
                  [-95.6409781951783, 36.1298748378408],
                  [-95.6409781951783, 36.13025611864012]]], null, false),
            {
              "LC": 4,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.69883874194677, 36.15028214577829],
                  [-95.69883874194677, 36.14974502305398],
                  [-95.6981950117832, 36.14974502305398],
                  [-95.6981950117832, 36.15028214577829]]], null, false),
            {
              "LC": 4,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-96.14291380465393, 36.28662686125462],
                  [-96.14291380465393, 36.28569285495976],
                  [-96.14166925967102, 36.28569285495976],
                  [-96.14166925967102, 36.28662686125462]]], null, false),
            {
              "LC": 4,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-96.36623094487229, 36.050199780597296],
                  [-96.36623094487229, 36.049748716633665],
                  [-96.3656945030693, 36.049748716633665],
                  [-96.3656945030693, 36.050199780597296]]], null, false),
            {
              "LC": 4,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-96.38304303097763, 36.04778829322549],
                  [-96.38304303097763, 36.04767118674212],
                  [-96.3828928272728, 36.04767118674212],
                  [-96.3828928272728, 36.04778829322549]]], null, false),
            {
              "LC": 4,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-96.37264509420409, 36.034289817445206],
                  [-96.37264509420409, 36.034072916270446],
                  [-96.3723768733026, 36.034072916270446],
                  [-96.3723768733026, 36.034289817445206]]], null, false),
            {
              "LC": 4,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-96.18637217048499, 35.73442192561151],
                  [-96.18637217048499, 35.734160656737934],
                  [-96.18596447471472, 35.734160656737934],
                  [-96.18596447471472, 35.73442192561151]]], null, false),
            {
              "LC": 4,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.86285717930782, 35.89779076263337],
                  [-95.86285717930782, 35.897060711358314],
                  [-95.86152680363644, 35.897060711358314],
                  [-95.86152680363644, 35.89779076263337]]], null, false),
            {
              "LC": 4,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.90167410817135, 35.897425737837466],
                  [-95.90167410817135, 35.8971823870384],
                  [-95.90143807377804, 35.8971823870384],
                  [-95.90143807377804, 35.897425737837466]]], null, false),
            {
              "LC": 4,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.87612236206121, 35.924276082116975],
                  [-95.87612236206121, 35.92391117949333],
                  [-95.87575758163518, 35.92391117949333],
                  [-95.87575758163518, 35.924276082116975]]], null, false),
            {
              "LC": 4,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.78302551265622, 35.936787990639374],
                  [-95.78302551265622, 35.934407781786014],
                  [-95.78045059200193, 35.934407781786014],
                  [-95.78045059200193, 35.936787990639374]]], null, false),
            {
              "LC": 4,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.78285385127927, 35.92916064491351],
                  [-95.78285385127927, 35.92559864827735],
                  [-95.77991415019895, 35.92559864827735],
                  [-95.77991415019895, 35.92916064491351]]], null, false),
            {
              "LC": 4,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.52795154646358, 35.99787632295021],
                  [-95.52795154646358, 35.995879887461406],
                  [-95.52280170515499, 35.995879887461406],
                  [-95.52280170515499, 35.99787632295021]]], null, false),
            {
              "LC": 4,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.60002786711178, 36.015824611939784],
                  [-95.60002786711178, 36.01179788523448],
                  [-95.59788209989986, 36.01179788523448],
                  [-95.59788209989986, 36.015824611939784]]], null, false),
            {
              "LC": 4,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.63311343470104, 36.02735780376126],
                  [-95.63311343470104, 36.027166913961224],
                  [-95.63286667147167, 36.027166913961224],
                  [-95.63286667147167, 36.02735780376126]]], null, false),
            {
              "LC": 4,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.63586804988036, 36.05881471955056],
                  [-95.63586804988036, 36.05440854319108],
                  [-95.63129756571898, 36.05440854319108],
                  [-95.63129756571898, 36.05881471955056]]], null, false),
            {
              "LC": 4,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.55623946778529, 36.0449272135493],
                  [-95.55623946778529, 36.042905944495466],
                  [-95.54858980767482, 36.042905944495466],
                  [-95.54858980767482, 36.0449272135493]]], null, false),
            {
              "LC": 4,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.47359495622553, 36.19472272005196],
                  [-95.47359495622553, 36.193995417081105],
                  [-95.4725649879638, 36.193995417081105],
                  [-95.4725649879638, 36.19472272005196]]], null, false),
            {
              "LC": 4,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.37289886735472, 36.2228036349882],
                  [-95.37289886735472, 36.221938107970786],
                  [-95.37178306840453, 36.221938107970786],
                  [-95.37178306840453, 36.2228036349882]]], null, false),
            {
              "LC": 4,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.35835056565794, 36.214632678428686],
                  [-95.35835056565794, 36.21407868438156],
                  [-95.35723476670775, 36.21407868438156],
                  [-95.35723476670775, 36.214632678428686]]], null, false),
            {
              "LC": 4,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.43721082027912, 36.20130258461231],
                  [-95.43721082027912, 36.200332927313184],
                  [-95.4358375292635, 36.200332927313184],
                  [-95.4358375292635, 36.20130258461231]]], null, false),
            {
              "LC": 4,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-95.46540620144367, 36.14289395499239],
                  [-95.46540620144367, 36.14237410990281],
                  [-95.46463372524738, 36.14237410990281],
                  [-95.46463372524738, 36.14289395499239]]], null, false),
            {
              "LC": 4,
              "system:index": "24"
            })]);
/***** End of imports. If edited, may not auto-convert in the playground. *****/

// Lab 10 section 5

///////////////////////////////////////////////////////////////////////////////////// 5.2

// Write a Function to mask clouds based on the QA_PIXEL band of Landsat 8 SR data.
function maskL8sr(image) {
  // Bits 3 and 4 are cloud and cloud shadow, respectively. SEE BANDS for reference
  var cloudsBitMask = (1 << 3); //pushes "1" 3 spaces to the left 
  var cloudShadowBitMask = (1 << 4);// pushes "1" 4 spaces to the left
  
  // Get the pixel QA band from the Landsat 8 collection level 2 SR image
  var qa = image.select('QA_PIXEL');
  // Set both flags to zero to indicate clear sky conditions.
  var mask = qa.bitwiseAnd(cloudShadowBitMask).eq(0)
                 .and(qa.bitwiseAnd(cloudsBitMask).eq(0));
  return image.updateMask(mask);
}

// Create a cloud-free Landsat 8 collection 2 level 1 collection covering the specific 
// region within a specific period
var l8collection = ee.ImageCollection('LANDSAT/LC08/C02/T1_L2')
    .filterDate('2020-01-01', '2020-12-31')
    .filterBounds(region)
    .map(maskL8sr);

// subset spectral bands
var l8optical = l8collection.select('SR_B[1-7]');

// Create a median composite from all cloud-free Landsat 8 pixels
var l8_input = l8optical.median();

// clip Landsat 8 composite to study region only
var l8_input = l8_input.clip(region);
print(l8_input)

// Define true-color visualization parameters for SR image.
var tc_sr = {
  bands: ['SR_B4', 'SR_B3', 'SR_B2'],
  min: 1000,
  max: 30000
};

// Display the true color composite Landsat 8 image
Map.centerObject(region,9);
Map.addLayer(l8_input, tc_sr, 'median Landsat 8 composite - True color');

// False color composite visualization parameters
var fcc_sr = {
  bands: ['SR_B5', 'SR_B4', 'SR_B3'],
  min: 1000,
  max: 30000
};

// Display the False color composite Landsat 8 image
Map.centerObject(region,9);
Map.addLayer(l8_input, fcc_sr, 'median Landsat 8 composite - FCC');

///////////////////////////////////////////////////////////////////////////////////// 5.4

// merge training polygons
var sample_polygon = Water.merge(Forest) //Merges all points
                          .merge(Urban)
                          .merge(Other);

///////////////////////////////////////////////////////////////////////////////////// 5.5

// generate training pixels from the training polygons
// the pixel values will have band values from the Landsat 8 image
var sample_pixels = l8_input.sampleRegions({
  collection: sample_polygon,
  properties: ['LC'],
  scale: 30
});

///////////////////////////////////////////////////////////////////////////////////// 5.6

// Add a random value field to the sample and use it to approximately split 70%
// of the features into a training set and 30% into a validation set.
sample_pixels = sample_pixels.randomColumn();
var trainingSample = sample_pixels.filter('random <= 0.7');
var validationSample = sample_pixels.filter('random > 0.7');

///////////////////////////////////////////////////////////////////////////////////// 5.7

// Train a 10-tree random forest classifier from the training sample.
var trainedClassifier = ee.Classifier.smileRandomForest(10).train({
  features: trainingSample,
  classProperty: 'LC',
  inputProperties: l8_input.bandNames()
});

// Get information about the trained classifier.
print('Results of trained classifier', trainedClassifier.explain());

///////////////////////////////////////////////////////////////////////////////////// 5.8

// Get a confusion matrix and overall accuracy for the training sample.
var trainAccuracy = trainedClassifier.confusionMatrix();
print('Training overall accuracy', trainAccuracy.accuracy().multiply(100));

///////////////////////////////////////////////////////////////////////////////////// 5.9

// Get a confusion matrix and overall accuracy for the validation sample.
validationSample = validationSample.classify(trainedClassifier);
var validationAccuracy = validationSample.errorMatrix("LC", 'classification');
print('Validation accuracy', validationAccuracy.accuracy().multiply(100));

///////////////////////////////////////////////////////////////////////////////////// 5.10

// Classify the L8 image from the trained classifier.
var new_lc = l8_input.classify(trainedClassifier);

///////////////////////////////////////////////////////////////////////////////////// 5.11

// Get reference dataset for accuracy assignment- extract pixel values from new land cover data
var validation = new_lc.sampleRegions({
  collection: val_points,
  scale: 30,
});
print(validation);

// define color palette to display the final land cover map
var lc_Palette = ['blue','green','red','white'];
Map.addLayer(new_lc,{min:1, max:4, palette: lc_Palette}, 'Land cover map');
//Compare the landcover of your validation data against the classification cluster
var confusionMatrix = validation.errorMatrix('ref_lc', 'classification');

//Print the error matrix to the console
print('Validation error matrix: ', confusionMatrix);

// Calculate overall accuracy to the console.
print("Overall accuracy (%)", confusionMatrix.accuracy().multiply(100));

// Calculate kappa coefficient to the console
print('Kappa coefficient (%)', confusionMatrix.kappa().multiply(100));

///////////////////////////////////////////////////////////////////////////////////// (5 Points)

// 1) Overall Accuracy
  /// 75.63884156729131 %

// 2) Kappa coefficient/statistic
  /// 62.4945266073902 %

///////////////////////////////////////////////////////////////////////////////////// Lab 12


// // Export the classified image to your google drive.
// You can create a new folder or use the existing folder or comment on the line (//folder: 'RS_labs',) to export the image to the main drive folder
Export.image.toDrive({
  image: new_lc, // image to be exported
  description: 'lc_tulsa_rf', // Name of the output image
  folder: 'RS_labs', // folder name, comment the line (//folder: 'RS_labs',) to export the image in the main drive folder
  region: region, // selected region/bounding box
  scale: 30, // resolution in meters
  crs: 'EPSG:5070', // coordinate reference system 
  formatOptions: {
    cloudOptimized: true
  }
});

// // Assign a common name to Landsat 5 and 8. Note that Band numbers/Designations are different in L5 and L8
var LC8_BANDS = ['B2',   'B3',    'B4',  'B5',  'B6',    'B7']; //Landsat 8
var LC5_BANDS = ['B1',   'B2',    'B3',  'B4',  'B5',    'B7']; //Landsat 5
var New_BNAMES = ['blue', 'green', 'red', 'nir', 'swir1', 'swir2'];

//Landsat 8
var l8 = ee.ImageCollection('LANDSAT/LC08/C02/T1_RT_TOA')
    .select(LC8_BANDS, New_BNAMES)
    .filterBounds(region)
    
//Landsat 5
var l5 = ee.ImageCollection('LANDSAT/LT05/C02/T1_TOA')
.select(LC5_BANDS, New_BNAMES)
.filterBounds(region)

// Merge Landsat 5 and Landsat 8
var landsat_merged = l5.merge(l8);

// Select bands, filter dates and clouds
var Landsat_collecton = ee.ImageCollection(landsat_merged
  .filter(ee.Filter.lt('CLOUD_COVER', 1))
  .filterDate('1984-01-01', '2022-12-31')
  .select(['red','green','blue']) // you can change the band combination
  .filterBounds(region));

// Convert Band values to Unassigned 8 bits.
var scale_fac = function(image){
 var image1 = image.multiply(512).uint8();
 return(image1)
}
  
// apply the scale factor function to all images within the image collection  
Landsat_collecton = Landsat_collecton.map(scale_fac);

Map.addLayer(region,{},"Region of interest")
Map.centerObject(region, 12);
  
Export.video.toDrive({
    collection: Landsat_collecton,
    description: "My_timeLapseVideo" ,
    dimensions:720,
    framesPerSecond: 5,
    region: region
});




